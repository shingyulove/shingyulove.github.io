<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>å¥³åƒ•æ‰‹ç¹ª Chekki (åœ–æ¡ˆæ“´å……ç‰ˆ)</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Dela+Gothic+One&family=RocknRoll+One&family=Yomogi&display=swap');

        :root {
            --bg-color: #fff5f7;
            --card-bg: #ffffff;
        }

        * { box-sizing: border-box; }

        body {
            background-color: var(--bg-color);
            background-image: 
                linear-gradient(#ffdce5 1px, transparent 1px),
                linear-gradient(90deg, #ffdce5 1px, transparent 1px);
            background-size: 20px 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-start;
            min-height: 100dvh;
            margin: 0;
            padding-top: 20px;
            padding-bottom: 40px;
            overflow-y: auto;
            overflow-x: hidden;
            user-select: none;
            font-family: 'Yomogi', cursive;
            -webkit-tap-highlight-color: transparent;
        }

        h1 {
            color: #ff8da1;
            font-family: 'RocknRoll One', sans-serif;
            margin: 0 0 15px 0;
            font-size: 1.4rem;
            letter-spacing: 2px;
            z-index: 10;
            text-shadow: 2px 2px 0 #fff;
        }

        .controls { margin-top: 20px; z-index: 100; padding-bottom: 20px; }

        button {
            background: #ff8da1;
            color: white;
            border: 3px solid #fff;
            padding: 12px 40px;
            border-radius: 50px;
            font-size: 1.1rem;
            font-weight: bold;
            font-family: 'RocknRoll One', sans-serif;
            cursor: pointer;
            box-shadow: 0 5px 15px rgba(255, 141, 161, 0.4);
            transition: transform 0.1s;
        }
        button:active { transform: scale(0.95); }

        .instax {
            position: relative;
            width: 340px;
            height: 540px;
            background: var(--card-bg);
            border-radius: 12px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.08);
            overflow: hidden;
            transform-origin: top center;
            flex-shrink: 0;
        }

        @media (max-width: 380px) {
            .instax { transform: scale(0.85); margin-bottom: -60px; }
        }

        .photo-area {
            position: absolute;
            top: 30px; left: 20px;
            width: 300px; height: 380px;
            background-color: #e0e0e0;
            background-image: radial-gradient(#d0d0d0 10%, transparent 10%);
            background-size: 15px 15px;
            z-index: 1;
            border-radius: 2px;
        }

        .canvas-layer {
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            z-index: 10; pointer-events: none;
        }

        .frame-image {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            object-fit: contain; z-index: 5; opacity: 0.9; pointer-events: none;
        }

        .signature-group {
            position: absolute; display: flex; flex-direction: column; align-items: center; z-index: 50;
        }
        .sig-name {
            font-family: 'RocknRoll One', sans-serif;
            font-size: 2.5rem; color: #ff6b8b; line-height: 1; text-shadow: 2px 2px 0 #fff;
        }
        .sig-date {
            font-family: 'Dela Gothic One', cursive;
            font-size: 1.1rem; color: #888; margin-top: 5px; text-shadow: 1px 1px 0 #fff;
        }

        .doodle-item {
            position: absolute; display: flex; justify-content: center; align-items: center;
            z-index: 20;
            animation: pop 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards;
        }

        .colored-icon {
            width: 100%; height: 100%;
            -webkit-mask-size: contain; mask-size: contain;
            -webkit-mask-repeat: no-repeat; mask-repeat: no-repeat;
            -webkit-mask-position: center; mask-position: center;
            opacity: 0.9;
        }

        .doodle-svg { opacity: 0.95; }
        
        .text-item {
            position: absolute; z-index: 25;
            font-weight: bold; white-space: nowrap;
            mix-blend-mode: multiply; line-height: 1;
        }

        @keyframes pop { from { transform: scale(0) rotate(0deg); opacity: 0; } to { opacity: 1; } }
    </style>
</head>
<body>

    <h1>ğŸ¨ å¥³åƒ•æ‰‹ç¹ª Chekki</h1>

    <div class="instax">
        <div class="photo-area"></div>
        <div class="canvas-layer" id="canvas"></div>
    </div>

    <div class="controls">
        <button onclick="generateArt()">âœ¨ ç”Ÿæˆé‚Šæ¡†èˆ‡è£é£¾ âœ¨</button>
    </div>

    <script>
        // ================= é…ç½®å€ =================
        
        /* 1. åœ–æ¡ˆåº« (Images) */
        const pngLibrary = [
            "./images/Favorite.png",
            "./images/2.png",
        ];

        /* 2. é‚Šæ¡†åº« (Frames) */
        const frameLibrary = [
             "./frames/border1.png", 
             "./frames/border2.png",

        ];

        // é…è‰²ç›¤
        const palette = ["#FF9AA2", "#FFB7B2", "#FFDAC1", "#E2F0CB", "#B5EAD7", "#C7CEEA", "#90BAD6", "#F0A6CA"];
        const penColors = ["#ff6b8b", "#ff9f43", "#5f27cd", "#54a0ff", "#1dd1a1"];
        const maidNames = ["Miku", "Rina", "Hana", "Momo", "Yuki", "Alice", "Coco", "omgg", "muli", "lilith"];
        const jpTexts = ["å¤§å¥½ã", "æ¨ã—â™¡", "ã«ã‚ƒã‚“", "LOVE", "ç¥å¯¾å¿œ", "èŒãˆ", "Chu!", "å°Šã„", "kawaii", "å–œæ­¡", "å¤§æ„›â™¡", "moemoe", "meow"];

        // ================= æ“´å……å¾Œçš„ SVG åº« =================
        const doodles = [
            // --- å¯¦å¿ƒåœ–æ¡ˆ (Fill) 10æ¬¾ ---
            // 1. å¯¦å¿ƒæ„›å¿ƒ
            { type: 'fill', path: 'M50,90 C20,60 0,40 20,20 C35,5 50,25 50,25 C50,25 65,5 80,20 C100,40 80,60 50,90 Z' },
            // 2. å¯¦å¿ƒæ˜Ÿæ˜Ÿ
            { type: 'fill', path: 'M50,5 L60,35 L95,35 L70,55 L80,90 L50,70 L20,90 L30,55 L5,35 L40,35 Z' },
            // 3. å¯¦å¿ƒè´è¶çµ
            { type: 'fill', path: 'M50,50 L20,20 Q10,50 20,80 L50,50 L80,80 Q90,50 80,20 Z' },
            // 4. å¯¦å¿ƒèŠ±æœµ
            { type: 'fill', path: 'M50,50 m-15,0 a15,15 0 1,0 30,0 a15,15 0 1,0 -30,0 M50,20 a12,12 0 1,0 0,24 M80,50 a12,12 0 1,0 -24,0 M50,80 a12,12 0 1,0 0,-24 M20,50 a12,12 0 1,0 24,0' },
            // 5. è²“é ­
            { type: 'fill', path: 'M20,40 Q15,15 40,25 L50,30 L60,25 Q85,15 80,40 Q90,60 80,80 Q50,90 20,80 Q10,60 20,40' },
            // 6. å…”é ­
            { type: 'fill', path: 'M30,30 Q30,0 45,20 Q50,25 55,20 Q70,0 70,30 Q80,40 70,60 Q50,70 30,60 Q20,40 30,30' },
            // 7. æ°£çƒ
            { type: 'fill', path: 'M50,50 m-25,0 a25,30 0 1,0 50,0 a25,30 0 1,0 -50,0 M50,80 L50,95' },
            // 8. é‘½çŸ³
            { type: 'fill', path: 'M30,30 L70,30 L90,50 L50,90 L10,50 Z' },
            // 9. æ«»æ¡ƒ/ç³–æœ
            { type: 'fill', path: 'M30,60 A10,10 0 1,1 50,60 A10,10 0 1,1 30,60 M55,55 A10,10 0 1,1 75,55 A10,10 0 1,1 55,55 M40,60 L65,55' },
            // 10. çš‡å† 
            { type: 'fill', path: 'M20,70 L20,40 L40,60 L50,30 L60,60 L80,40 L80,70 Z' },

            // --- ç©ºå¿ƒç·šæ¢ (Stroke) 10æ¬¾ ---
            // 1. é–ƒå…‰
            { type: 'stroke', path: 'M50,10 Q60,40 90,50 Q60,60 50,90 Q40,60 10,50 Q40,40 50,10' },
            // 2. èºæ—‹
            { type: 'stroke', path: 'M50,50 m-20,0 a20,20 0 1,1 40,0 a20,20 0 1,1 -40,0 a10,10 0 1,1 20,0' },
            // 3. é›²æœµ
            { type: 'stroke', path: 'M20,60 Q30,40 40,50 Q50,30 70,40 Q80,40 80,60 Q80,70 20,70' },
            // 4. æ‰‹ç¹ªæ˜Ÿæ˜Ÿ (ç·šæ¢)
            { type: 'stroke', path: 'M50,10 L60,40 L90,40 L65,60 L75,90 L50,70 L25,90 L35,60 L10,40 L40,40 Z' },
            // 5. XX
            { type: 'stroke', path: 'M30,30 L70,70 M70,30 L30,70' },
            // 7. ç¬‘è‡‰
            { type: 'stroke', path: 'M30,40 Q50,35 70,40 M30,40 L25,45 M70,40 L75,45 M50,60 Q50,70 50,70' },
            // 8. ä¿¡å°
            { type: 'stroke', path: 'M20,30 L80,30 L80,70 L20,70 Z M20,30 L50,55 L80,30' },
            // 9. ç¿…è†€
            { type: 'stroke', path: 'M50,50 Q20,20 10,40 Q30,50 50,50 Q70,50 90,40 Q80,20 50,50' },
            // 10. æ±—é¡æ°´æ»´
            { type: 'stroke', path: 'M50,20 C20,50 20,80 50,90 C80,80 80,50 50,20 Z' }
        ];

        let occupiedRects = [];

        function generateArt() {
            const canvas = document.getElementById('canvas');
            canvas.innerHTML = '';
            occupiedRects = [];

            drawHybridFrame(canvas);
            drawSignature(canvas);

            const textCount = 1 + Math.floor(Math.random() * 2);
            for(let i=0; i<textCount; i++) drawText(canvas);

            // å¢åŠ ç”Ÿæˆæ•¸é‡ï¼šè‡³å°‘ 8 å€‹ï¼Œæœ€å¤š 12 å€‹
            const doodleCount = 8 + Math.floor(Math.random() * 5);
            for(let i=0; i<doodleCount; i++) drawRandomAsset(canvas);
        }

        function drawRandomAsset(container) {
            const usePng = (pngLibrary.length > 0) && (Math.random() < 0.6);
            if (usePng) {
                drawPngSticker(container);
            } else {
                drawSvgDoodle(container);
            }
        }

        function drawPngSticker(container) {
            const src = pngLibrary[Math.floor(Math.random() * pngLibrary.length)];
            const color = palette[Math.floor(Math.random() * palette.length)];
            const el = document.createElement('div');
            el.className = 'doodle-item';
            
            const icon = document.createElement('div');
            icon.className = 'colored-icon';
            icon.style.backgroundColor = color;
            icon.style.webkitMaskImage = `url('${src}')`;
            icon.style.maskImage = `url('${src}')`;
            
            el.appendChild(icon);

            const size = 45 + Math.random() * 45; 
            el.style.width = `${size}px`; el.style.height = `${size}px`;
            const rot = (Math.random() - 0.5) * 40; const scale = 0.9 + Math.random() * 0.2;
            el.style.transform = `rotate(${rot}deg) scale(${scale})`;
            container.appendChild(el);
            placeItem(el, size, size, container);
        }

        function drawSvgDoodle(container) {
            const data = doodles[Math.floor(Math.random() * doodles.length)];
            const color = palette[Math.floor(Math.random() * palette.length)];
            const size = 50 + Math.random() * 50; 
            const el = document.createElement('div');
            el.className = 'doodle-item doodle-svg';
            el.style.width = `${size}px`; el.style.height = `${size}px`;
            const strokeWidth = 2 + Math.random() * 3;
            
            let svgContent = '';
            // æ ¹æ“šé¡å‹æ±ºå®šæ˜¯å¡«å……é‚„æ˜¯æé‚Š
            if (data.type === 'fill') {
                svgContent = `<path d="${data.path}" fill="${color}" stroke="none" opacity="0.9"/>`;
            } else {
                svgContent = `<path d="${data.path}" stroke="${color}" stroke-width="${strokeWidth}" fill="none" stroke-linecap="round" stroke-linejoin="round"/>`;
            }

            el.innerHTML = `<svg viewBox="0 0 100 100" style="overflow:visible; width:100%; height:100%">${svgContent}</svg>`;
            const rot = (Math.random() - 0.5) * 90; const scale = 0.7 + Math.random() * 0.6; 
            el.style.transform = `rotate(${rot}deg) scale(${scale})`;
            container.appendChild(el);
            placeItem(el, size, size, container);
        }

        function drawHybridFrame(container) {
            const hasExternal = frameLibrary.length > 0;
            const useExternal = hasExternal && (Math.random() < 0.3);
            if (useExternal) {
                const src = frameLibrary[Math.floor(Math.random() * frameLibrary.length)];
                const img = document.createElement('img');
                img.src = src; img.className = 'frame-image';
                img.onerror = function() { this.remove(); drawInternalSvgBorder(container); };
                container.appendChild(img);
            } else {
                drawInternalSvgBorder(container);
            }
        }

        function drawInternalSvgBorder(container) {
            const svgNS = "http://www.w3.org/2000/svg";
            const svg = document.createElementNS(svgNS, "svg");
            Object.assign(svg.style, {
                position: 'absolute', top: 0, left: 0, width: '100%', height: '100%',
                zIndex: 5, pointerEvents: 'none'
            });

            const color = palette[Math.floor(Math.random() * palette.length)];
            const type = Math.floor(Math.random() * 8); 
            const x=20, y=30, w=300, h=380; 

            switch (type) {
                case 0: drawPath(svg, generateWobblyRect(x, y, w, h), color, 3); break;
                case 1: drawPath(svg, generateWobblyRect(x, y, w, h), color, 2); const color2 = palette[Math.floor(Math.random() * palette.length)]; drawPath(svg, generateWobblyRect(x+5, y+5, w, h), color2, 2); break;
                case 2: drawDecoratedRect(svg, x, y, w, h, color, 'circle'); break;
                case 3: drawDecoratedRect(svg, x, y, w, h, color, 'cross'); break;
                case 4: drawLaceRect(svg, x, y, w, h, color); break;
                case 5: drawDecoratedRect(svg, x, y, w, h, color, 'heart'); break;
                case 6: drawCornerBorder(svg, x, y, w, h, color); break;
                case 7: drawDashedBorder(svg, x, y, w, h, color); break;
            }
            container.appendChild(svg);
        }

        function drawPath(svg, d, color, width, dashed = false) {
            const path = document.createElementNS("http://www.w3.org/2000/svg", "path");
            path.setAttribute("d", d); path.setAttribute("fill", "none");
            path.setAttribute("stroke", color); path.setAttribute("stroke-width", width);
            path.setAttribute("stroke-linecap", "round"); path.setAttribute("opacity", "0.8");
            if(dashed) path.setAttribute("stroke-dasharray", "10, 10");
            svg.appendChild(path);
        }
        function drawDashedBorder(svg, x, y, w, h, color) { drawPath(svg, generateWobblyRect(x, y, w, h), color, 3, true); }
        function drawCornerBorder(svg, x, y, w, h, color) {
            const len = 40; 
            drawPath(svg, `M ${x} ${y+len} L ${x} ${y} L ${x+len} ${y}`, color, 4);
            drawPath(svg, `M ${x+w-len} ${y} L ${x+w} ${y} L ${x+w} ${y+len}`, color, 4);
            drawPath(svg, `M ${x+w} ${y+h-len} L ${x+w} ${y+h} L ${x+w-len} ${y+h}`, color, 4);
            drawPath(svg, `M ${x+len} ${y+h} L ${x} ${y+h} L ${x} ${y+h-len}`, color, 4);
        }
        function drawLaceRect(svg, x, y, w, h, color) {
            drawPath(svg, `M ${x} ${y} L ${x+w} ${y} L ${x+w} ${y+h} L ${x} ${y+h} Z`, color, 1);
            const radius = 10; 
            const drawScallops = (bx, by, dx, dy, steps) => {
                for(let i=0; i<steps; i++) {
                    const sx = bx + dx * i * (radius*2); const sy = by + dy * i * (radius*2);
                    const circle = document.createElementNS("http://www.w3.org/2000/svg", "circle");
                    circle.setAttribute("cx", sx + (dx?radius:0) + (dy?0:radius)); 
                    circle.setAttribute("cy", sy + (dy?radius:0) + (dx?0:radius));
                    circle.setAttribute("r", radius/1.5); circle.setAttribute("fill", "none");
                    circle.setAttribute("stroke", color); circle.setAttribute("stroke-width", 2);
                    svg.appendChild(circle);
                }
            };
            const hSteps = Math.floor(w / (radius*2)); const vSteps = Math.floor(h / (radius*2));
            drawScallops(x, y, 1, 0, hSteps); drawScallops(x, y+h, 1, 0, hSteps);
            drawScallops(x, y, 0, 1, vSteps); drawScallops(x+w, y, 0, 1, vSteps);
        }
        function drawDecoratedRect(svg, x, y, w, h, color, shape) {
            const gap = 30; 
            const drawPoint = (px, py) => {
                const jx = px + (Math.random()-0.5)*5; const jy = py + (Math.random()-0.5)*5;
                if (shape === 'circle') {
                    const circle = document.createElementNS("http://www.w3.org/2000/svg", "circle");
                    circle.setAttribute("cx", jx); circle.setAttribute("cy", jy);
                    circle.setAttribute("r", 3 + Math.random()*2); circle.setAttribute("fill", "none");
                    circle.setAttribute("stroke", color); circle.setAttribute("stroke-width", 2);
                    svg.appendChild(circle);
                } else if (shape === 'cross') {
                    const cross = document.createElementNS("http://www.w3.org/2000/svg", "path");
                    const s = 4; cross.setAttribute("d", `M${jx-s},${jy-s} L${jx+s},${jy+s} M${jx+s},${jy-s} L${jx-s},${jy+s}`);
                    cross.setAttribute("stroke", color); cross.setAttribute("stroke-width", 2);
                    cross.setAttribute("stroke-linecap", "round"); svg.appendChild(cross);
                } else if (shape === 'heart') {
                    const heart = document.createElementNS("http://www.w3.org/2000/svg", "path");
                    heart.setAttribute("d", "M0,-5 C-5,-10 -10,-5 -10,0 C-10,5 -5,10 0,15 C5,10 10,5 10,0 C10,-5 5,-10 0,-5 Z");
                    heart.setAttribute("transform", `translate(${jx}, ${jy}) scale(0.5)`);
                    heart.setAttribute("fill", "none"); heart.setAttribute("stroke", color);
                    heart.setAttribute("stroke-width", 3); svg.appendChild(heart);
                }
            };
            for(let i=x; i<=x+w; i+=gap) { drawPoint(i, y); drawPoint(i, y+h); }
            for(let i=y; i<=y+h; i+=gap) { drawPoint(x, i); drawPoint(x+w, i); }
        }
        function generateWobblyRect(x, y, w, h) {
            const wiggle = () => (Math.random() - 0.5) * 10;
            return `M ${x+wiggle()} ${y+wiggle()} L ${x+w+wiggle()} ${y+wiggle()} L ${x+w+wiggle()} ${y+h+wiggle()} L ${x+wiggle()} ${y+h+wiggle()} Z`;
        }

        function drawSignature(container) {
            const group = document.createElement('div');
            group.className = 'signature-group';
            const name = maidNames[Math.floor(Math.random() * maidNames.length)];
            const today = new Date();
            const dateStr = `${today.getFullYear()}.${today.getMonth()+1}.${today.getDate()}`;
            group.innerHTML = `<div class="sig-name">${name} <span style="font-size:0.6em">â™¡</span></div><div class="sig-date">${dateStr}</div>`;
            group.querySelector('.sig-name').style.color = penColors[Math.floor(Math.random() * penColors.length)];
            container.appendChild(group);
            const w = 200; const h = 100; const rot = (Math.random() - 0.5) * 15;
            group.style.transform = `rotate(${rot}deg)`;
            placeItem(group, w, h, container, true);
        }

        function drawText(container) {
            const text = jpTexts[Math.floor(Math.random() * jpTexts.length)];
            const el = document.createElement('div'); el.className = 'text-item'; el.innerText = text;
            el.style.color = palette[Math.floor(Math.random() * palette.length)];
            el.style.fontSize = `${24 + Math.random() * 20}px`;
            el.style.fontFamily = Math.random() > 0.5 ? "'RocknRoll One'" : "'Yomogi'";
            const rot = (Math.random() - 0.5) * 40; el.style.transform = `rotate(${rot}deg)`;
            container.appendChild(el); placeItem(el, text.length * 30, 40, container);
        }

        function placeItem(el, w, h, container, preferEdge = false) {
            const containerW = 340; const containerH = 540; const padding = 5; // æ¸›å°‘é‚Šè·ï¼Œè®“æ›´å¤šåœ–æ¡ˆèƒ½å¡é€²å»
            let found = false;
            // å¢åŠ å˜—è©¦æ¬¡æ•¸ï¼Œç¢ºä¿èƒ½æ‰¾åˆ°ä½ç½®
            for(let i=0; i<100; i++) {
                const left = Math.random() * (containerW - w - padding);
                const top = Math.random() * (containerH - h - padding);
                const newRect = { left, top, right: left + w, bottom: top + h };
                if (!checkCollision(newRect)) {
                    if (preferEdge && top > 120 && top < 380) { if (Math.random() > 0.1) continue; }
                    el.style.left = `${left}px`; el.style.top = `${top}px`;
                    occupiedRects.push(newRect); found = true; break;
                }
            }
            if (!found) el.remove();
        }
        function checkCollision(r1) {
            const buffer = 2; // æ¸›å°‘ç·©è¡è·é›¢ï¼Œå…è¨±åœ–æ¡ˆç¨å¾®é è¿‘ä¸€é»
            for (let r2 of occupiedRects) {
                if (r1.left < r2.right + buffer && r1.right > r2.left - buffer && r1.top < r2.bottom + buffer && r1.bottom > r2.top - buffer) return true;
            }
            return false;
        }
        window.onload = generateArt;
    </script>
</body>
</html>
