<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>å¥³åƒ•æ‰‹ç¹ª Chekki (å¤šæ¨£æ€§UPç‰ˆ)</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Dela+Gothic+One&family=RocknRoll+One&family=Yomogi&display=swap');

        :root {
            --bg-color: #fff0f5;
            --card-bg: #ffffff;
        }

        * { box-sizing: border-box; }

        body {
            background-color: var(--bg-color);
            background-image: 
                linear-gradient(45deg, #ffc2d1 25%, transparent 25%, transparent 75%, #ffc2d1 75%, #ffc2d1),
                linear-gradient(45deg, #ffc2d1 25%, transparent 25%, transparent 75%, #ffc2d1 75%, #ffc2d1);
            background-size: 20px 20px;
            background-position: 0 0, 10px 10px;
            
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-start;
            min-height: 100dvh;
            margin: 0;
            padding-top: 20px;
            padding-bottom: 40px;
            overflow-y: auto;
            overflow-x: hidden;
            user-select: none;
            font-family: 'Yomogi', cursive;
            -webkit-tap-highlight-color: transparent;
        }

        h1 {
            color: #ff6b8b;
            font-family: 'RocknRoll One', sans-serif;
            margin: 0 0 15px 0;
            font-size: 1.4rem;
            text-shadow: 2px 2px 0 #fff;
            z-index: 10;
        }

        .controls { margin-top: 20px; z-index: 100; padding-bottom: 20px; }

        button {
            background: #ff6b8b;
            color: white;
            border: 3px solid #fff;
            padding: 12px 40px;
            border-radius: 50px;
            font-size: 1.1rem;
            font-weight: bold;
            font-family: 'RocknRoll One', sans-serif;
            cursor: pointer;
            box-shadow: 0 5px 10px rgba(255, 107, 139, 0.3);
            transition: transform 0.1s;
        }
        
        button:active { transform: scale(0.95); }

        .instax {
            position: relative;
            width: 340px;
            height: 540px;
            background: var(--card-bg);
            border-radius: 10px;
            box-shadow: 0 15px 40px rgba(50,50,93,0.1);
            overflow: hidden;
            transform-origin: top center;
            flex-shrink: 0;
        }

        @media (max-width: 380px) {
            .instax { transform: scale(0.85); margin-bottom: -60px; }
        }

        .photo-area {
            position: absolute;
            top: 30px; left: 20px;
            width: 300px; height: 380px;
            background-color: #eee;
            background-image: url('https://placehold.co/600x800/ffe6eb/ff8da1?text=Maid+Photo'); 
            background-size: cover;
            background-position: center;
            z-index: 1;
            border: 2px solid #fff;
            box-shadow: inset 0 0 20px rgba(0,0,0,0.05);
        }

        .canvas-layer {
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            z-index: 10; pointer-events: none;
        }

        /* ç°½åçµ„ä»¶ */
        .signature-group {
            position: absolute;
            display: flex;
            flex-direction: column;
            align-items: center;
            z-index: 50;
        }
        .sig-name {
            font-family: 'RocknRoll One', sans-serif;
            font-size: 2.5rem; color: #ff4081; line-height: 1;
            text-shadow: 2px 2px 0 #fff;
        }
        .sig-date {
            font-family: 'Dela Gothic One', cursive;
            font-size: 1.1rem; color: #555; margin-top: 5px;
            text-shadow: 1px 1px 0 #fff;
        }

        /* åœ–æ¡ˆé€šç”¨ */
        .doodle-item {
            position: absolute;
            display: flex; justify-content: center; align-items: center;
            z-index: 20;
            animation: pop 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards;
        }

        /* SVG æ‰‹ç¹ªé¢¨æ ¼ï¼šé¡è‰²ç–ŠåŠ  */
        .doodle-svg {
            mix-blend-mode: multiply; 
            opacity: 0.9;
        }

        /* Emoji è²¼ç´™é¢¨æ ¼ï¼šä¸é€æ˜ï¼Œæœ‰é™°å½± */
        .doodle-emoji {
            font-size: 100%; /* ç”±çˆ¶å®¹å™¨æ§åˆ¶å¤§å° */
            mix-blend-mode: normal;
            filter: drop-shadow(2px 3px 0 rgba(0,0,0,0.1));
        }

        /* æ–‡å­—é¢¨æ ¼ */
        .text-item {
            position: absolute; z-index: 25;
            font-weight: bold; white-space: nowrap;
            mix-blend-mode: multiply; line-height: 1;
        }

        @keyframes pop {
            from { transform: scale(0) rotate(0deg); opacity: 0; }
            to { opacity: 1; } 
        }
    </style>
</head>
<body>

    <h1>ğŸ¨ å¥³åƒ•æ‰‹ç¹ª Chekki</h1>

    <div class="instax">
        <div class="photo-area"></div>
        <div class="canvas-layer" id="canvas"></div>
    </div>

    <div class="controls">
        <button onclick="generateArt()">âœ¨ æ³¨å…¥èŒèŒèƒ½é‡ âœ¨</button>
    </div>

    <script>
        // ================= è³‡æ–™åº« =================
        
        // é¡è‰²ï¼šæ›´å¤šå…ƒï¼ŒåŒ…å«ä¸€äº›æ·±è‰²ç·šæ¢è‰²
        const colors = ["#ff5c8d", "#ff9eb5", "#54a0ff", "#ffce54", "#a29bfe", "#00b894", "#ff7675", "#636e72"];
        const maidNames = ["Miku", "Rina", "Hana", "Momo", "Yuki", "Alice", "Coco", "Nene"];
        const jpTexts = ["å¤§å¥½ã", "æ¨ã—â™¡", "ã«ã‚ƒã‚“", "ã‚ã–ã¨", "LOVE", "ç¥å¯¾å¿œ", "èŒãˆ", "Chu!", "å°Šã„", "å¤©ä½¿"];
        
        // Emoji åˆ—è¡¨ (å¯æ„›å°ç‰©ä»¶)
        const emojis = ["ğŸ€", "ğŸ“", "âœ¨", "ğŸ°", "ğŸ¥º", "ğŸ¾", "ğŸ¬", "ğŸ’", "ğŸ§¸", "ğŸ’Œ", "ğŸŒ¸", "ğŸ¼", "ğŸ­", "ğŸ°", "ğŸ±"];

        /* 
           SVG åœ–æ¡ˆåº« 
           type: 'fill' (å¯¦å¿ƒ) - é©åˆç•¶èƒŒæ™¯é»ç¶´
           type: 'stroke' (ç©ºå¿ƒ/ç·šæ¢) - æ¨¡æ“¬åŸå­ç­†/éº¥å…‹ç­†æ‰‹ç¹ªï¼Œé€™æ˜¯ä½ æƒ³è¦çš„é‡é»
        */
        const doodles = [
            // --- ç©ºå¿ƒ/ç·šæ¢ (Hollow/Stroke) --- å¤šåŠ ä¸€é»
            { type: 'stroke', path: 'M50,10 Q60,40 90,50 Q60,60 50,90 Q40,60 10,50 Q40,40 50,10' }, // é–ƒå…‰
            { type: 'stroke', path: 'M20,20 L40,40 M40,20 L20,40 M60,20 L80,40 M80,20 L60,40' }, // XX ç¬¦è™Ÿ
            { type: 'stroke', path: 'M50,20 C20,20 10,50 30,70 L50,90 L70,70 C90,50 80,20 50,20 Z' }, // ç©ºå¿ƒæ„›å¿ƒ
            { type: 'stroke', path: 'M10,50 Q30,20 50,50 T90,50' }, // æ³¢æµªç·š
            { type: 'stroke', path: 'M50,50 m-20,0 a20,20 0 1,1 40,0 a20,20 0 1,1 -40,0' }, // åœ“åœˆ
            { type: 'stroke', path: 'M30,30 L30,70 L70,70 L70,30 Z' }, // æ–¹å¡Š
            { type: 'stroke', path: 'M20,50 Q35,20 50,50 Q65,80 80,50' }, // æ›²ç·š
            { type: 'stroke', path: 'M50,20 L50,35 M50,65 L50,80 M20,50 L35,50 M65,50 L80,50' }, // åå­—å…‰èŠ’
            { type: 'stroke', path: 'M25,25 Q50,5 75,25 T75,75 T25,75 T25,25' }, // é›²æœµ/èŠ±å‹
            { type: 'stroke', path: 'M50,10 C20,40 20,80 50,90 C80,80 80,40 50,10 Z' }, // æ°´æ»´ (æ±—)
            { type: 'stroke', path: 'M10,40 Q20,10 30,40 M40,40 Q50,10 60,40 M70,40 Q80,10 90,40' }, // ç”Ÿæ°£ç¬¦è™Ÿ (Puku)
            { type: 'stroke', path: 'M20,40 L80,40 M20,60 L80,60 M30,40 L30,60 M70,40 L70,60' }, // OKç¹ƒ
            { type: 'stroke', path: 'M50,50 L50,90 M50,50 L30,20 Q50,10 70,20 Z' }, // æ°£çƒ

            // --- å¯¦å¿ƒ (Fill) --- 
            { type: 'fill', path: 'M50,90 C20,60 0,40 20,20 C35,5 50,25 50,25 C50,25 65,5 80,20 C100,40 80,60 50,90 Z' }, // å¯¦å¿ƒæ„›å¿ƒ
            { type: 'fill', path: 'M50,5 L60,35 L95,35 L70,55 L80,90 L50,70 L20,90 L30,55 L5,35 L40,35 Z' }, // æ˜Ÿæ˜Ÿ
            { type: 'fill', path: 'M20,80 Q10,10 50,30 Q90,10 80,80 Z' }, // è²“è€³
            { type: 'fill', path: 'M50,50 L10,30 Q5,50 10,70 L50,50 L90,70 Q95,50 90,30 Z' } // è´è¶çµ
        ];

        let occupiedRects = [];

        // ================= é‚è¼¯å€ =================

        function generateArt() {
            const canvas = document.getElementById('canvas');
            canvas.innerHTML = '';
            occupiedRects = [];

            drawWobblyBorder(canvas);
            drawSignature(canvas);

            // éš¨æ©Ÿç”Ÿæˆ 1-2 å¥æ—¥æ–‡
            const textCount = 1 + Math.floor(Math.random() * 2);
            for(let i=0; i<textCount; i++) drawText(canvas);

            // éš¨æ©Ÿç”Ÿæˆ 6-10 å€‹å°åœ–æ¡ˆ (å¢åŠ æ•¸é‡ï¼Œå› ç‚ºç¾åœ¨åœ–æ¡ˆæ¯”è¼ƒå°å·§å¯æ„›)
            const doodleCount = 6 + Math.floor(Math.random() * 5);
            for(let i=0; i<doodleCount; i++) drawRandomItem(canvas);
        }

        // çµ±ä¸€è™•ç†ï¼šæ±ºå®šç•« Emoji é‚„æ˜¯ SVG
        function drawRandomItem(container) {
            // 30% æ©Ÿç‡æ˜¯ Emojiï¼Œ70% æ©Ÿç‡æ˜¯æ‰‹ç¹ªç·šæ¢/è‰²å¡Š
            const isEmoji = Math.random() < 0.3;

            if (isEmoji) {
                drawEmoji(container);
            } else {
                drawDoodle(container);
            }
        }

        function drawEmoji(container) {
            const emojiChar = emojis[Math.floor(Math.random() * emojis.length)];
            const el = document.createElement('div');
            el.className = 'doodle-item doodle-emoji';
            el.innerText = emojiChar;
            
            // Emoji å¤§å°
            const size = 35 + Math.random() * 25; 
            el.style.fontSize = `${size}px`;
            
            const rot = (Math.random() - 0.5) * 60; 
            const scale = 0.9 + Math.random() * 0.3;
            el.style.transform = `rotate(${rot}deg) scale(${scale})`;

            container.appendChild(el);
            placeItem(el, size, size, container);
        }

        function drawDoodle(container) {
            const data = doodles[Math.floor(Math.random() * doodles.length)];
            const color = colors[Math.floor(Math.random() * colors.length)];
            const size = 40 + Math.random() * 60; // 40-100px
            
            const el = document.createElement('div');
            el.className = 'doodle-item doodle-svg';
            el.style.width = `${size}px`;
            el.style.height = `${size}px`;

            // éš¨æ©Ÿç­†è§¸ç²—ç´° (2px - 6px)ï¼Œæ¨¡æ“¬çœŸå¯¦æ‰‹ç¹ª
            const strokeWidth = 2 + Math.random() * 4;
            let svgContent = '';

            if (data.type === 'stroke') {
                // ç©ºå¿ƒç·šæ¢ï¼šé‡é»ï¼fill="none"
                svgContent = `<path d="${data.path}" stroke="${color}" stroke-width="${strokeWidth}" fill="none" stroke-linecap="round" stroke-linejoin="round"/>`;
            } else {
                // å¯¦å¿ƒè‰²å¡Š
                svgContent = `<path d="${data.path}" fill="${color}" stroke="none"/>`;
            }

            el.innerHTML = `<svg viewBox="0 0 100 100" style="overflow:visible; width:100%; height:100%">${svgContent}</svg>`;

            const rot = (Math.random() - 0.5) * 90; // æ—‹è½‰å¹…åº¦å¤§ä¸€é»
            const scale = 0.7 + Math.random() * 0.6; 
            el.style.transform = `rotate(${rot}deg) scale(${scale})`;

            container.appendChild(el);
            placeItem(el, size, size, container);
        }

        function drawSignature(container) {
            const group = document.createElement('div');
            group.className = 'signature-group';
            
            const name = maidNames[Math.floor(Math.random() * maidNames.length)];
            const today = new Date();
            const dateStr = `${today.getFullYear()}.${today.getMonth()+1}.${today.getDate()}`;

            group.innerHTML = `
                <div class="sig-name">${name} <span style="font-size:0.6em">â™¡</span></div>
                <div class="sig-date">${dateStr}</div>
            `;

            container.appendChild(group);

            const w = 200; const h = 100; 
            const rot = (Math.random() - 0.5) * 15;
            group.style.transform = `rotate(${rot}deg)`;

            placeItem(group, w, h, container, true);
        }

        function drawText(container) {
            const text = jpTexts[Math.floor(Math.random() * jpTexts.length)];
            const el = document.createElement('div');
            el.className = 'text-item';
            el.innerText = text;
            el.style.color = colors[Math.floor(Math.random() * colors.length)];
            el.style.fontSize = `${24 + Math.random() * 20}px`;
            el.style.fontFamily = Math.random() > 0.5 ? "'RocknRoll One'" : "'Yomogi'";
            
            const rot = (Math.random() - 0.5) * 40;
            el.style.transform = `rotate(${rot}deg)`;

            container.appendChild(el);
            placeItem(el, text.length * 30, 40, container);
        }

        function drawWobblyBorder(container) {
            const svg = document.createElementNS("http://www.w3.org/2000/svg", "svg");
            svg.style.position = 'absolute';
            svg.style.top = '0'; svg.style.left = '0'; svg.style.width = '100%'; svg.style.height = '100%';
            svg.style.zIndex = '5'; svg.style.pointerEvents = 'none';

            const color = colors[Math.floor(Math.random() * colors.length)];
            const pathStr = generateWobblyRect(20, 30, 300, 380);
            
            const path = document.createElementNS("http://www.w3.org/2000/svg", "path");
            path.setAttribute("d", pathStr);
            path.setAttribute("fill", "none");
            path.setAttribute("stroke", color);
            path.setAttribute("stroke-width", "3");
            path.setAttribute("stroke-linecap", "round");
            path.setAttribute("opacity", "0.6");

            svg.appendChild(path);
            container.appendChild(svg);
        }

        function generateWobblyRect(x, y, w, h) {
            const wiggle = () => (Math.random() - 0.5) * 12; // æŠ–å‹•å¹…åº¦åŠ å¤§
            return `M ${x + wiggle()} ${y + wiggle()} L ${x + w + wiggle()} ${y + wiggle()} L ${x + w + wiggle()} ${y + h + wiggle()} L ${x + wiggle()} ${y + h + wiggle()} Z`;
        }

        function placeItem(el, w, h, container, preferEdge = false) {
            const containerW = 340;
            const containerH = 540;
            const padding = 10;
            let found = false;

            for(let i=0; i<30; i++) {
                const left = Math.random() * (containerW - w - padding);
                const top = Math.random() * (containerH - h - padding);
                const newRect = { left, top, right: left + w, bottom: top + h };

                if (!checkCollision(newRect)) {
                    // å¦‚æœæ˜¯ç°½åï¼Œç›¡é‡é¿é–‹ç…§ç‰‡æ­£ä¸­é–“(è‡‰éƒ¨å€åŸŸ)
                    if (preferEdge && top > 120 && top < 380) {
                        if (Math.random() > 0.1) continue; 
                    }
                    el.style.left = `${left}px`;
                    el.style.top = `${top}px`;
                    occupiedRects.push(newRect);
                    found = true;
                    break;
                }
            }
            if (!found) el.remove();
        }

        function checkCollision(r1) {
            const buffer = 5;
            for (let r2 of occupiedRects) {
                if (r1.left < r2.right + buffer && r1.right > r2.left - buffer && r1.top < r2.bottom + buffer && r1.bottom > r2.top - buffer) {
                    return true;
                }
            }
            return false;
        }

        window.onload = generateArt;
    </script>
</body>
</html>
